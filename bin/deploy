#!/bin/bash
# Homebrew does not allow sudo.

#set -x #debug
set -eu

./bin/setup

mitamae() {
  cookbooks=$@
  case "$(uname)" in
    "Darwin")  bin/mitamae local $cookbooks ;;
    *) sudo -i bash -c "cd $(pwd) && bin/mitamae local -l debug lib/recipe_helper.rb $cookbooks" ;;
  esac
}

if [ "$#" = "0" ]; then
  mitamae lib/recipe.rb
else
  mitamae $@
fi
